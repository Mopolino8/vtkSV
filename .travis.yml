language: cpp

matrix:
  include:
    - os: linux
      compiler: gcc
      dist: trusty
      sudo: required
      env: VTK_VERSION=6.2
    - os: linux
      compiler: gcc
      dist: trusty
      sudo: required
      env: VTK_VERSION=7.0
    - os: osx
      compiler: clang
      osx_image: xcode7.3
      sudo: required
      env: VTK_VERSION=6.2
    - os: osx
      compiler: clang
      osx_image: xcode7.3
      sudo: required
      env: VTK_VERSION=7.0
  allow_failures:
    - os: osx
    - env: VTK_VERSION=7.0

addons:
  apt:
    packages:
    - curl
    - cmake

git:
  submodules: false

before_install:
  - export NUM_THREADS=4
  - export cwd=$(pwd)
  - export SCRIPTS=$cwd/travis
  - export EXTERNALS_DIR=/usr/local/travis/external
  - export VTK_SOURCE_DIR=$EXTERNALS_DIR/vtk-$VTK_VERSION
  - export VTK_DIR=$EXTERNALS_DIR/vtk-$VTK_VERSION-build
  - export BUILD_DIR=$cwd/build

cache:
  directories:
  - /usr/local/travis/external/vtk-6.2
  - /usr/local/travis/external/vtk-6.2-build
  - /usr/local/travis/external/vtk-7.0
  - /usr/local/travis/external/vtk-7.0-build

before_script:
  - $SCRIPTS/travis_build_vtk.sh

script: $SCRIPTS/travis_build_and_test.sh
